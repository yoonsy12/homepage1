<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ì´ˆë“±í•™êµ 6í•™ë…„ ìš°ë¦¬ë°˜ í™ˆí˜ì´ì§€ì…ë‹ˆë‹¤. íŒŒì´ì–´ë² ì´ìŠ¤ë¥¼ ì´ìš©í•œ ì‹¤ì‹œê°„ ê°€ì •í†µì‹ ë¬¸ê³¼ ë¡œê·¸ì¸ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.">
    <title>6í•™ë…„ ìš°ë¦¬ë°˜ í™ˆí˜ì´ì§€</title>
    <style>
        /* ì „ì²´ ìŠ¤íƒ€ì¼ */
        body {
            font-family: 'Jua', 'Malgun Gothic', sans-serif;
            background-color: #f0f8ff;
            margin: 0;
            padding: 0;
            color: #333;
        }

        /* í—¤ë” */
        header {
            background-color: #4facfe;
            background-image: linear-gradient(to right, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        header h1 {
            margin: 0;
            font-size: 2.5em;
        }

        /* ë„¤ë¹„ê²Œì´ì…˜ */
        nav {
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            justify-content: center;
            padding: 10px;
        }

        nav button {
            background: none;
            border: none;
            font-size: 1.2em;
            margin: 0 15px;
            cursor: pointer;
            color: #555;
            font-weight: bold;
            padding: 10px 20px;
            border-radius: 20px;
            transition: background-color 0.3s;
        }

        nav button:hover {
            background-color: #e0f7fa;
            color: #007bff;
        }

        /* ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ */
        main {
            max-width: 800px;
            margin: 30px auto;
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            min-height: 400px;
        }

        .hidden {
            display: none;
        }

        h2 {
            border-bottom: 3px solid #4facfe;
            padding-bottom: 10px;
            color: #007bff;
        }

        /* ê°€ì •í†µì‹ ë¬¸ ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .notice-item {
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.2s;
        }

        .notice-item:hover {
            transform: scale(1.02);
            background-color: #fafafa;
            cursor: pointer;
        }

        .notice-date {
            font-size: 0.9em;
            color: #888;
        }

        /* í¼ ìŠ¤íƒ€ì¼ (ë¡œê·¸ì¸/íšŒì›ê°€ì…) */
        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }

        .btn-submit {
            width: 100%;
            padding: 12px;
            background-color: #4facfe;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.1em;
            cursor: pointer;
            margin-top: 10px;
        }

        .btn-submit:hover {
            background-color: #007bff;
        }
    </style>
</head>
<body>

    <header>
        <h1>ğŸ« 6í•™ë…„ ìš°ë¦¬ë°˜ í™ˆí˜ì´ì§€</h1>
    </header>

    <nav>
        <button onclick="showSection('home')">í™ˆ</button>
        <button onclick="showSection('notice')">ê°€ì •í†µì‹ ë¬¸</button>
        <button id="nav-login" onclick="showSection('login')">ë¡œê·¸ì¸</button>
        <button id="nav-signup" onclick="showSection('signup')">íšŒì›ê°€ì…</button>
        <button id="nav-logout" onclick="logout()" class="hidden">ë¡œê·¸ì•„ì›ƒ</button>
    </nav>

    <main id="content">
        <!-- í™ˆ í™”ë©´ -->
        <section id="home">
            <h2>í™˜ì˜í•©ë‹ˆë‹¤! ğŸ‘‹</h2>
            <p>ìš°ë¦¬ë°˜ ì¹œêµ¬ë“¤ì„ ìœ„í•œ ì†Œí†µ ê³µê°„ì…ë‹ˆë‹¤.</p>
            <p>ì˜¤ëŠ˜ì˜ ê¸‰ì‹, ìˆ™ì œ, ê·¸ë¦¬ê³  ì¬ë¯¸ìˆëŠ” ì†Œì‹ë“¤ì„ í™•ì¸í•´ë³´ì„¸ìš”.</p>
            <div style="text-align: center; margin-top: 50px;">
                <img src="https://cdn-icons-png.flaticon.com/512/3413/3413535.png" alt="í•™êµ ì•„ì´ì½˜" width="150">
            </div>
        </section>

        <!-- ê°€ì •í†µì‹ ë¬¸ í™”ë©´ -->
        <section id="notice" class="hidden">
            <h2>ğŸ“¢ ê°€ì •í†µì‹ ë¬¸ & ì•Œë¦¼ì¥</h2>
            
            <!-- ê¸€ì“°ê¸° ì˜ì—­ (ë¡œê·¸ì¸ ì‹œ ë³´ì„) -->
            <div id="write-area" class="hidden" style="margin-bottom: 20px; padding: 15px; background: #f9f9f9; border-radius: 8px;">
                <input type="text" id="notice-content" placeholder="ìƒˆë¡œìš´ ì†Œì‹ì„ ì…ë ¥í•˜ì„¸ìš”" style="width: 75%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                <button onclick="addNotice()" style="width: 20%; padding: 10px; background: #4facfe; color: white; border: none; border-radius: 5px; cursor: pointer;">ë“±ë¡</button>
            </div>

            <div class="notice-list" id="notice-list">
                <!-- ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë¶ˆëŸ¬ì˜¨ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                <p style="text-align: center; color: #888;">ë¡œë”© ì¤‘...</p>
            </div>
        </section>

        <!-- ë¡œê·¸ì¸ í™”ë©´ -->
        <section id="login" class="hidden">
            <h2>ğŸ” ë¡œê·¸ì¸</h2>
            <div class="form-group">
                <label>ì´ë©”ì¼</label>
                <input type="email" id="login-email" placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”">
            </div>
            <div class="form-group">
                <label>ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" id="login-pw" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
            </div>
            <button class="btn-submit" onclick="login()">ë¡œê·¸ì¸ í•˜ê¸°</button>
        </section>

        <!-- íšŒì›ê°€ì… í™”ë©´ -->
        <section id="signup" class="hidden">
            <h2>ğŸ“ íšŒì›ê°€ì…</h2>
            <div class="form-group">
                <label>ì´ë©”ì¼</label>
                <input type="email" id="signup-email" placeholder="ì´ë©”ì¼ ì£¼ì†Œ (ì˜ˆ: student@school.com)">
            </div>
            <div class="form-group">
                <label>ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" id="signup-pw" placeholder="ë¹„ë°€ë²ˆí˜¸ (6ìë¦¬ ì´ìƒ)">
            </div>
            <button class="btn-submit" onclick="signup()">ê°€ì…í•˜ê¸°</button>
        </section>
    </main>

    <script type="module">
        // íŒŒì´ì–´ë² ì´ìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ ê°€ì ¸ì˜¤ê¸° (CDN)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-analytics.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        // íŒŒì´ì–´ë² ì´ìŠ¤ ì„¤ì • (ì œê³µí•´ì£¼ì‹  ì •ë³´)
        const firebaseConfig = {
            apiKey: "AIzaSyAxuYOr0rmW-FZ9mZ_xhqVprblZOAon73M",
            authDomain: "yoonsy12-8f65a.firebaseapp.com",
            projectId: "yoonsy12-8f65a",
            storageBucket: "yoonsy12-8f65a.firebasestorage.app",
            messagingSenderId: "805668475758",
            appId: "1:805668475758:web:64e1f089a5628d5bd7e77f",
            measurementId: "G-S0C9WB904X"
        };

        // íŒŒì´ì–´ë² ì´ìŠ¤ ì´ˆê¸°í™”
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // ê´€ë¦¬ì ì´ë©”ì¼ ì„¤ì • (ì„ ìƒë‹˜ ê³„ì •)
        const ADMIN_EMAIL = "teacher@school.com";

        // 1. í™”ë©´ ì „í™˜ í•¨ìˆ˜ (ì „ì—­ í•¨ìˆ˜ë¡œ ë“±ë¡)
        window.showSection = function(sectionId) {
            // ëª¨ë“  ì„¹ì…˜ì„ ìˆ¨ê¹€
            const sections = document.querySelectorAll('main > section');
            sections.forEach(section => {
                section.classList.add('hidden');
            });
            // ì„ íƒí•œ ì„¹ì…˜ë§Œ ë³´ì—¬ì¤Œ
            document.getElementById(sectionId).classList.remove('hidden');
        }

        // 2. íšŒì›ê°€ì… í•¨ìˆ˜
        window.signup = async function() {
            const email = document.getElementById('signup-email').value;
            const pw = document.getElementById('signup-pw').value;
            if (!email || !pw) return alert("ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            
            try {
                await createUserWithEmailAndPassword(auth, email, pw);
                alert("ê°€ì… ì„±ê³µ! í™˜ì˜í•©ë‹ˆë‹¤.");
                window.showSection('home');
            } catch (error) {
                alert("ê°€ì… ì‹¤íŒ¨: " + error.message);
            }
        }

        // 3. ë¡œê·¸ì¸ í•¨ìˆ˜
        window.login = async function() {
            const email = document.getElementById('login-email').value;
            const pw = document.getElementById('login-pw').value;
            if (!email || !pw) return alert("ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");

            try {
                await signInWithEmailAndPassword(auth, email, pw);
                alert("ë¡œê·¸ì¸ ë˜ì—ˆìŠµë‹ˆë‹¤!");
                window.showSection('home');
            } catch (error) {
                alert("ë¡œê·¸ì¸ ì‹¤íŒ¨: " + error.message);
            }
        }

        // 4. ë¡œê·¸ì•„ì›ƒ í•¨ìˆ˜
        window.logout = async function() {
            await signOut(auth);
            alert("ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.");
            window.showSection('home');
        }

        // 5. ê°€ì •í†µì‹ ë¬¸ ê¸€ì“°ê¸° í•¨ìˆ˜
        window.addNotice = async function() {
            // ê´€ë¦¬ì ê¶Œí•œ í™•ì¸
            if (!auth.currentUser || auth.currentUser.email !== ADMIN_EMAIL) {
                return alert("ì„ ìƒë‹˜ë§Œ ê¸€ì„ ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            }

            const content = document.getElementById('notice-content').value;
            if (!content) return alert("ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.");
            
            try {
                await addDoc(collection(db, "notices"), {
                    content: content,
                    date: new Date().toISOString().split('T')[0], // YYYY-MM-DD í˜•ì‹
                    timestamp: serverTimestamp()
                });
                document.getElementById('notice-content').value = ""; // ì…ë ¥ì°½ ë¹„ìš°ê¸°
            } catch (error) {
                console.error("ê¸€ì“°ê¸° ì˜¤ë¥˜:", error);
                alert("ê¸€ì„ ì €ì¥í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. (ê¶Œí•œ ë¬¸ì œì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤)");
            }
        }

        // 6. ë¡œê·¸ì¸ ìƒíƒœ ê°ì§€ ë° UI ë³€ê²½
        onAuthStateChanged(auth, (user) => {
            const navLogin = document.getElementById('nav-login');
            const navSignup = document.getElementById('nav-signup');
            const navLogout = document.getElementById('nav-logout');
            const writeArea = document.getElementById('write-area');

            if (user) {
                // ë¡œê·¸ì¸ ìƒíƒœ
                navLogin.classList.add('hidden');
                navSignup.classList.add('hidden');
                navLogout.classList.remove('hidden');
                
                // ê´€ë¦¬ì(ì„ ìƒë‹˜)ì¸ ê²½ìš°ì—ë§Œ ê¸€ì“°ê¸° ì°½ ë³´ì´ê¸°
                if (user.email === ADMIN_EMAIL) {
                    writeArea.classList.remove('hidden');
                } else {
                    writeArea.classList.add('hidden');
                }
            } else {
                // ë¡œê·¸ì•„ì›ƒ ìƒíƒœ
                navLogin.classList.remove('hidden');
                navSignup.classList.remove('hidden');
                navLogout.classList.add('hidden');
                writeArea.classList.add('hidden'); // ê¸€ì“°ê¸° ì°½ ìˆ¨ê¸°ê¸°
            }
        });

        // 7. ê°€ì •í†µì‹ ë¬¸ ì‹¤ì‹œê°„ ë¶ˆëŸ¬ì˜¤ê¸° (Realtime Listener)
        const q = query(collection(db, "notices"), orderBy("timestamp", "desc"));
        onSnapshot(q, (snapshot) => {
            const list = document.getElementById('notice-list');
            list.innerHTML = ""; // ê¸°ì¡´ ëª©ë¡ ì´ˆê¸°í™”
            
            if (snapshot.empty) {
                list.innerHTML = "<p style='text-align:center'>ë“±ë¡ëœ ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>";
            }

            snapshot.forEach((doc) => {
                const data = doc.data();
                const item = document.createElement('div');
                item.className = 'notice-item';
                item.innerHTML = `
                    <span>${data.content}</span>
                    <span class="notice-date">${data.date}</span>
                `;
                list.appendChild(item);
            });
        });
    </script>
</body>
</html>
